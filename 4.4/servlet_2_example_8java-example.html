<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>51Degrees Geo-Location Java: servlet/Example.java</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="examplegrabber.js"></script>
<script type="text/javascript" src="search51.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="docs-main.min.css" rel="stylesheet" type="text/css" />
</head>
<body class="l-docs-index p-doxygen">
<div class="l-index__content">
<!--div id="top"--><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" class="g-header g-header--docs">
  <h1 class="c-brand">
  <a id="projectlogo" href="../../documentation/4.4/index.html" class="c-brand__link"><img class="c-brand__image" alt="Logo" src="logo-51Degrees-Docs.png" style="width:172px;"/></a>
  <span class="c-tagline">51Degrees Geo-Location Java
   &#160;<span id="projectnumber">4.4</span>
  </span>
  </h1>
  <div id="projectalign" style="padding-left: 0.5em;">
   <div id="projectbrief">Geo-location services for 51Degrees Pipeline</div>
  </div>
  <div id="main-nav"></div>
  <section class="g-search">
    <div class="c-search is-openable" id="searchOpenable">
    <form class="c-search__form">
      <div class="b-form-group b-form-group--with-icon">
        <label for="inputSearch" class="b-text--hidden">Search</label>
        <img src="icon-search.svg" class="b-icon" alt="Search" />
        <input type="text" class="c-search__input" id="inputSearch" onkeyup="javascript:onSearch(this,event.keyCode)" placeholder="Search" aria-label="Search">
      </div>
    </form>
    <div class="c-search__content" id="searchContent">
    </div>
  </div> 
  </section>
   <!--  <div class="g-search">
    <div class="c-search is-openable">
    <form class="c-search__form">
      <div id="MSearchBox" class="b-form-group b-form-group--with-icon">
        <label for="inputSearch" class="b-text--hidden">Search</label>
        <img id="MSearchSelect" src="icon-search.svg" class="b-icon" alt="Search" 
                 onmouseover="return searchBox.OnSearchSelectShow()"
                 onmouseout="return searchBox.OnSearchSelectHide()"/>
        <input type="text" id="MSearchField" autocomplete="off" class="c-search__input" id="inputSearch" placeholder="Type a class, namespace etc." aria-label="Search"
                 onfocus="searchBox.OnSearchFieldFocus(true)" 
                 onblur="searchBox.OnSearchFieldFocus(false)" 
                 onkeyup="searchBox.OnSearchFieldChange(event)">
         <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
      </div>
    </form>
  </div>
</div>
-->
</div>
<!-- end header part -->
<main class="g-main">
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<!-- top -->
	<div class="g-docs__sidenav">																														         <nav id="nav-tree-contents" class="c-sidenav">																														     <h4 class="c-sidenav__heading">Documentation</h4>																									         <div id="nav-sync" class="sync"></div>
  <ul class="c-sidenav__list">																														     </ul>																																				   </nav>    </div><script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('servlet_2_example_8java-example.html','');});
/* @license-end */
</script>
<div id="doc-content" class="g-docs__content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="g-docs__header">
<h2 class="g-docs__page-title">servlet/Example.java</h2></div><!--header-->
<div class="g-docs__inner">
<div class="g-docs__primary" id="primary">
<p>Servlet geo location exampleThis example shows how to:</p>
<ol type="1">
<li>Set up configuration options to add elements to the 51Degrees Pipeline.</li>
</ol>
<div class="c-code__block c-code__block--outline"><div class="c-code__line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;?<span class="c-code__keyword">xml</span> <span class="c-code__keyword">version</span>=<span class="c-code__stringliteral">&quot;1.0&quot;</span> <span class="c-code__keyword">encoding</span>=<span class="c-code__stringliteral">&quot;utf-8&quot;</span> ?&gt;</div><div class="c-code__line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="c-code__comment">&lt;!--</span></div><div class="c-code__line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="c-code__comment">  ~ This Original Work is copyright of 51 Degrees Mobile Experts Limited.</span></div><div class="c-code__line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="c-code__comment">  ~ Copyright 2022 51 Degrees Mobile Experts Limited, Davidson House,</span></div><div class="c-code__line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="c-code__comment">  ~ Forbury Square, Reading, Berkshire, United Kingdom RG1 3EU.</span></div><div class="c-code__line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="c-code__comment">  ~</span></div><div class="c-code__line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="c-code__comment">  ~ This Original Work is licensed under the European Union Public Licence</span></div><div class="c-code__line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="c-code__comment">  ~  (EUPL) v.1.2 and is subject to its terms as set out below.</span></div><div class="c-code__line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="c-code__comment">  ~</span></div><div class="c-code__line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="c-code__comment">  ~  If a copy of the EUPL was not distributed with this file, You can obtain</span></div><div class="c-code__line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="c-code__comment">  ~  one at https://opensource.org/licenses/EUPL-1.2.</span></div><div class="c-code__line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="c-code__comment">  ~</span></div><div class="c-code__line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="c-code__comment">  ~  The &#39;Compatible Licences&#39; set out in the Appendix to the EUPL (as may be</span></div><div class="c-code__line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="c-code__comment">  ~  amended by the European Commission) shall be deemed incompatible for</span></div><div class="c-code__line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="c-code__comment">  ~  the purposes of the Work and the provisions of the compatibility</span></div><div class="c-code__line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="c-code__comment">  ~  clause in Article 5 of the EUPL shall not apply.</span></div><div class="c-code__line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="c-code__comment">  ~</span></div><div class="c-code__line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="c-code__comment">  ~   If using the Work as, or as part of, a network application, by</span></div><div class="c-code__line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="c-code__comment">  ~   including the attribution notice(s) required under Article 5 of the EUPL</span></div><div class="c-code__line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="c-code__comment">  ~   in the end user terms of the application under an appropriate heading,</span></div><div class="c-code__line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="c-code__comment">  ~   such notice(s) shall fulfill the requirements of that article.</span></div><div class="c-code__line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="c-code__comment">  --&gt;</span></div><div class="c-code__line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="c-code__line"><a name="l00024"></a><span class="lineno">   24</span>&#160;&lt;<span class="c-code__keywordtype">PipelineOptions</span>&gt;</div><div class="c-code__line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    &lt;<span class="c-code__keywordtype">Elements</span>&gt;</div><div class="c-code__line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        &lt;<span class="c-code__keywordtype">Element</span>&gt;</div><div class="c-code__line"><a name="l00027"></a><span class="lineno">   27</span>&#160;            &lt;<span class="c-code__keywordtype">BuildParameters</span>&gt;</div><div class="c-code__line"><a name="l00028"></a><span class="lineno">   28</span>&#160;                &lt;<span class="c-code__keywordtype">EndPoint</span>&gt;<span class="c-code__keyword">https:</span>//<span class="c-code__keyword">cloud.51degrees.com</span>/<span class="c-code__keyword">api</span>/<span class="c-code__keyword">v4</span>&lt;/<span class="c-code__keywordtype">EndPoint</span>&gt;</div><div class="c-code__line"><a name="l00029"></a><span class="lineno">   29</span>&#160;                <span class="c-code__comment">&lt;!-- Obtain a resource key for free at</span></div><div class="c-code__line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="c-code__comment">                https://configure.51degrees.com</span></div><div class="c-code__line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="c-code__comment">                Make sure to include the &#39;Country&#39;,&#39;State&#39;,</span></div><div class="c-code__line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="c-code__comment">                &#39;County&#39;,&#39;Town&#39; properties as they are used</span></div><div class="c-code__line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="c-code__comment">                by this example. --&gt;</span></div><div class="c-code__line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                &lt;<span class="c-code__keywordtype">ResourceKey</span>&gt;!!<span class="c-code__keyword">YOUR_RESOURCE_KEY</span>!!&lt;/<span class="c-code__keywordtype">ResourceKey</span>&gt;</div><div class="c-code__line"><a name="l00035"></a><span class="lineno">   35</span>&#160;            &lt;/<span class="c-code__keywordtype">BuildParameters</span>&gt;</div><div class="c-code__line"><a name="l00036"></a><span class="lineno">   36</span>&#160;            &lt;<span class="c-code__keywordtype">BuilderName</span>&gt;<span class="c-code__keyword">CloudRequestEngine</span>&lt;/<span class="c-code__keywordtype">BuilderName</span>&gt;</div><div class="c-code__line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        &lt;/<span class="c-code__keywordtype">Element</span>&gt;</div><div class="c-code__line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        &lt;<span class="c-code__keywordtype">Element</span>&gt;</div><div class="c-code__line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            &lt;<span class="c-code__keywordtype">BuildParameters</span>&gt;</div><div class="c-code__line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                &lt;<span class="c-code__keywordtype">GeoLocationProvider</span>&gt;<span class="c-code__keyword">FiftyOneDegrees</span>&lt;/<span class="c-code__keywordtype">GeoLocationProvider</span>&gt;</div><div class="c-code__line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            &lt;/<span class="c-code__keywordtype">BuildParameters</span>&gt;</div><div class="c-code__line"><a name="l00042"></a><span class="lineno">   42</span>&#160;            &lt;<span class="c-code__keywordtype">BuilderName</span>&gt;<span class="c-code__keyword">GeoLocationCloudEngine</span>&lt;/<span class="c-code__keywordtype">BuilderName</span>&gt;</div><div class="c-code__line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        &lt;/<span class="c-code__keywordtype">Element</span>&gt;</div><div class="c-code__line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    &lt;/<span class="c-code__keywordtype">Elements</span>&gt;</div><div class="c-code__line"><a name="l00045"></a><span class="lineno">   45</span>&#160;&lt;/<span class="c-code__keywordtype">PipelineOptions</span>&gt;</div></div><ol type="1">
<li>Configure the filter and map it to be run for all URLs. <div class="c-code__block c-code__block--outline"><div class="c-code__line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;<span class="c-code__keywordtype">web-app</span> <span class="c-code__keyword">version</span>=<span class="c-code__stringliteral">&quot;3.1&quot;</span> <span class="c-code__keyword">xmlns</span>=<span class="c-code__stringliteral">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span> <span class="c-code__keyword">xmlns:xsi</span>=<span class="c-code__stringliteral">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="c-code__keyword">xsi:schemaLocation</span>=<span class="c-code__stringliteral">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;</span>&gt;</div><div class="c-code__line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    ...</div><div class="c-code__line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    &lt;<span class="c-code__keywordtype">filter</span>&gt;</div><div class="c-code__line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        &lt;<span class="c-code__keywordtype">filter-name</span>&gt;<span class="c-code__keyword">Pipeline</span>&lt;/<span class="c-code__keywordtype">filter-name</span>&gt;</div><div class="c-code__line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        &lt;<span class="c-code__keywordtype">filter-class</span>&gt;<span class="c-code__keyword">fiftyone.pipeline.web.PipelineFilter</span>&lt;/<span class="c-code__keywordtype">filter-class</span>&gt;</div><div class="c-code__line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        &lt;<span class="c-code__keywordtype">init-param</span>&gt;</div><div class="c-code__line"><a name="l00007"></a><span class="lineno">    7</span>&#160;            &lt;<span class="c-code__keywordtype">param-name</span>&gt;<span class="c-code__keyword">clientside-properties-enabled</span>&lt;/<span class="c-code__keywordtype">param-name</span>&gt;</div><div class="c-code__line"><a name="l00008"></a><span class="lineno">    8</span>&#160;            &lt;<span class="c-code__keywordtype">param-value</span>&gt;<span class="c-code__keyword">true</span>&lt;/<span class="c-code__keywordtype">param-value</span>&gt;</div><div class="c-code__line"><a name="l00009"></a><span class="lineno">    9</span>&#160;        &lt;/<span class="c-code__keywordtype">init-param</span>&gt;</div><div class="c-code__line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    &lt;/<span class="c-code__keywordtype">filter</span>&gt;</div><div class="c-code__line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    &lt;<span class="c-code__keywordtype">filter-mapping</span>&gt;</div><div class="c-code__line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        &lt;<span class="c-code__keywordtype">filter-name</span>&gt;<span class="c-code__keyword">Pipeline</span>&lt;/<span class="c-code__keywordtype">filter-name</span>&gt;</div><div class="c-code__line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        &lt;<span class="c-code__keywordtype">url-pattern</span>&gt;/*&lt;/<span class="c-code__keywordtype">url-pattern</span>&gt;</div><div class="c-code__line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    &lt;/<span class="c-code__keywordtype">filter-mapping</span>&gt;</div><div class="c-code__line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    ...</div></div></li>
<li>Add the <code>FlowDataProvider</code> to the servlet.</li>
<li>User the results contained in the flow data to display something on a page, and optionally add the client-side code to improve detection accuracy on devices like iPhones.</li>
</ol>
<h2>Servlet</h2>
<div class="c-code__block c-code__block--outline"><div class="c-code__line"><span class="c-code__comment">/*</span></div><div class="c-code__line"><span class="c-code__comment"> * This Original Work is copyright of 51 Degrees Mobile Experts Limited.</span></div><div class="c-code__line"><span class="c-code__comment"> * Copyright 2022 51 Degrees Mobile Experts Limited, Davidson House,</span></div><div class="c-code__line"><span class="c-code__comment"> * Forbury Square, Reading, Berkshire, United Kingdom RG1 3EU.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> * This Original Work is licensed under the European Union Public Licence</span></div><div class="c-code__line"><span class="c-code__comment"> *  (EUPL) v.1.2 and is subject to its terms as set out below.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> *  If a copy of the EUPL was not distributed with this file, You can obtain</span></div><div class="c-code__line"><span class="c-code__comment"> *  one at https://opensource.org/licenses/EUPL-1.2.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> *  The &#39;Compatible Licences&#39; set out in the Appendix to the EUPL (as may be</span></div><div class="c-code__line"><span class="c-code__comment"> *  amended by the European Commission) shall be deemed incompatible for</span></div><div class="c-code__line"><span class="c-code__comment"> *  the purposes of the Work and the provisions of the compatibility</span></div><div class="c-code__line"><span class="c-code__comment"> *  clause in Article 5 of the EUPL shall not apply.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> *   If using the Work as, or as part of, a network application, by</span></div><div class="c-code__line"><span class="c-code__comment"> *   including the attribution notice(s) required under Article 5 of the EUPL</span></div><div class="c-code__line"><span class="c-code__comment"> *   in the end user terms of the application under an appropriate heading,</span></div><div class="c-code__line"><span class="c-code__comment"> *   such notice(s) shall fulfill the requirements of that article.</span></div><div class="c-code__line"><span class="c-code__comment"> */</span></div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">package </span>fiftyone.geolocation.web.examples.servlet;</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">import</span> fiftyone.geolocation.core.data.GeoData;</div><div class="c-code__line"><span class="c-code__keyword">import</span> fiftyone.geolocation.web.examples.shared.EmbedTomcat;</div><div class="c-code__line"><span class="c-code__keyword">import</span> fiftyone.pipeline.core.data.FlowData;</div><div class="c-code__line"><span class="c-code__keyword">import</span> fiftyone.pipeline.engines.data.AspectPropertyValue;</div><div class="c-code__line"><span class="c-code__keyword">import</span> fiftyone.pipeline.engines.exceptions.NoValueException;</div><div class="c-code__line"><span class="c-code__keyword">import</span> fiftyone.pipeline.web.services.FlowDataProviderCore;</div><div class="c-code__line"><span class="c-code__keyword">import</span> org.apache.catalina.LifecycleException;</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">import</span> javax.servlet.ServletException;</div><div class="c-code__line"><span class="c-code__keyword">import</span> javax.servlet.http.HttpServlet;</div><div class="c-code__line"><span class="c-code__keyword">import</span> javax.servlet.http.HttpServletRequest;</div><div class="c-code__line"><span class="c-code__keyword">import</span> javax.servlet.http.HttpServletResponse;</div><div class="c-code__line"><span class="c-code__keyword">import</span> java.io.IOException;</div><div class="c-code__line"><span class="c-code__keyword">import</span> java.io.PrintWriter;</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">public</span> <span class="c-code__keyword">class </span>Example <span class="c-code__keyword">extends</span> HttpServlet {</div><div class="c-code__line">    <span class="c-code__keyword">public</span> <span class="c-code__keyword">static</span> <span class="c-code__keywordtype">void</span> main(String[] args) <span class="c-code__keywordflow">throws</span> LifecycleException {</div><div class="c-code__line">        EmbedTomcat.runWebApp(<span class="c-code__stringliteral">&quot;geo-location.web.examples/geo-location.web.examples.servlet/src/main/webapp&quot;</span>,</div><div class="c-code__line">            <span class="c-code__stringliteral">&quot;geo-location.web.examples/geo-location.web.examples.servlet/target&quot;</span>,</div><div class="c-code__line">            8080);</div><div class="c-code__line">    }</div><div class="c-code__line">    <span class="c-code__keyword">private</span> <span class="c-code__keyword">static</span> <span class="c-code__keyword">final</span> <span class="c-code__keywordtype">long</span> serialVersionUID = -7420567024186859548L;</div><div class="c-code__line">    FlowDataProviderCore flowDataProvider = <span class="c-code__keyword">new</span> FlowDataProviderCore.Default();</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__keyword">protected</span> <span class="c-code__keywordtype">void</span> <a name="a0"></a><a class="code" href="classfiftyone_1_1geolocation_1_1web_1_1examples_1_1servlet_1_1_example.html#a512a34c561a29823c17e0aef5e57840f">processRequest</a>(HttpServletRequest request, HttpServletResponse response)</div><div class="c-code__line">            <span class="c-code__keywordflow">throws</span> ServletException, IOException, NoValueException {</div><div class="c-code__line">        FlowData data = flowDataProvider.getFlowData(request);</div><div class="c-code__line">        GeoData geo = data.get(GeoData.class);</div><div class="c-code__line">        response.setContentType(<span class="c-code__stringliteral">&quot;text/html;charset=UTF-8&quot;</span>);</div><div class="c-code__line">        <span class="c-code__keywordflow">try</span> (PrintWriter out = response.getWriter()) {</div><div class="c-code__line">            out.println(<span class="c-code__stringliteral">&quot;&lt;!DOCTYPE html&gt;&quot;</span>);</div><div class="c-code__line">            out.println(<span class="c-code__stringliteral">&quot;&lt;html&gt;&quot;</span>);</div><div class="c-code__line">            out.println(<span class="c-code__stringliteral">&quot;&lt;head&gt;&quot;</span>);</div><div class="c-code__line">            out.println(<span class="c-code__stringliteral">&quot;&lt;title&gt;Servlet Example&lt;/title&gt;&quot;</span>);</div><div class="c-code__line">            out.println(<span class="c-code__stringliteral">&quot;&lt;/head&gt;&quot;</span>);</div><div class="c-code__line">            out.println(<span class="c-code__stringliteral">&quot;&lt;body&gt;&quot;</span>);</div><div class="c-code__line">            out.println(<span class="c-code__stringliteral">&quot;&lt;script src=\&quot;/geo-location.web.examples.servlet/51Degrees.core.js\&quot;&gt;&lt;/script&gt;&quot;</span>);</div><div class="c-code__line"></div><div class="c-code__line">            AspectPropertyValue&lt;String&gt; town = geo.getTown();</div><div class="c-code__line">            AspectPropertyValue&lt;String&gt; county = geo.getCounty();</div><div class="c-code__line">            AspectPropertyValue&lt;String&gt; state = geo.getState();</div><div class="c-code__line">            AspectPropertyValue&lt;String&gt; country = geo.getCountry();</div><div class="c-code__line"></div><div class="c-code__line">            out.println(<span class="c-code__stringliteral">&quot;&lt;h2&gt;Example&lt;/h2&gt;\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;&lt;div id=\&quot;content\&quot;&gt;\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;    &lt;p&gt;\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        The following values are determined sever-side on the first request.\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        As the server has no location information to work from, these \n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        values will all be unknown:\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;    &lt;/p&gt;\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;    &lt;dl&gt;\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        &lt;dt&gt;&lt;strong&gt;Country&lt;/strong&gt;&lt;/dt&gt;\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        &lt;dv&gt;&quot;</span> + (county.hasValue() ? county.getValue() : <span class="c-code__stringliteral">&quot;Unknown: &quot;</span> + county.getNoValueMessage()) + <span class="c-code__stringliteral">&quot;&lt;/dv&gt;\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        &lt;dt&gt;&lt;strong&gt;State&lt;/strong&gt;&lt;/dt&gt;\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        &lt;dv&gt;&quot;</span> + (state.hasValue() ? state.getValue() : <span class="c-code__stringliteral">&quot;Unknown: &quot;</span> +  state.getNoValueMessage()) + <span class="c-code__stringliteral">&quot;&lt;/dv&gt;\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        &lt;dt&gt;&lt;strong&gt;County&lt;/strong&gt;&lt;/dt&gt;\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        &lt;dv&gt;&quot;</span> + (country.hasValue() ? country.getValue() : <span class="c-code__stringliteral">&quot;Unknown: &quot;</span> +  country.getNoValueMessage()) + <span class="c-code__stringliteral">&quot;&lt;/dv&gt;\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        &lt;dt&gt;&lt;strong&gt;Town/City&lt;/strong&gt;&lt;/dt&gt;\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        &lt;dv&gt;&quot;</span> + (town.hasValue() ? town.getValue() : <span class="c-code__stringliteral">&quot;Unknown: &quot;</span> +  town.getNoValueMessage()) + <span class="c-code__stringliteral">&quot;&lt;/dv&gt;\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;    &lt;/dl&gt;   \n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;    &lt;p&gt;\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        When the button below is clicked, JavaScript running on the client-side will be used to obtain additional evidence (i.e. the location information from the device). If no additional information appears then it may indicate an external problem such as JavaScript being disabled in your browser.\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;    &lt;/p&gt;\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;    &lt;p&gt;\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        Note that the accuracy of the information is dependent on the accuracy of the location data returned by your device. Any device that lacks GPS is likely to return a highly inaccurate result. Among devices with GPS, some have a significantly lower margin of error than others.\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;    &lt;/p&gt;\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;    &lt;button type=\&quot;button\&quot; onclick=\&quot;buttonClicked()\&quot;&gt;Use my location&lt;/button&gt;\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;&lt;/div&gt;\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;&lt;script&gt;\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;    buttonClicked = function () {\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        // This function will fire when the JSON data object is updated\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        // with information from the server.\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        // The sequence is:\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        // 1. Response contains JavaScript property &#39;JavaScript&#39;. This is not executed immediately on the client as it will prompt the user to allow access to location.\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        // 2. When the button is clicked, the fod.complete function is called, passing &#39;location&#39; as the second parameter. This lets the code know that we want to execute\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        // any JavaScript needed to obtain the location data that is needed to determine the user&#39;s postal address details.\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        // 3. The execution of the location JavaScript triggers a background callback to the webserver that includes the new evidence (i.e. lat/lon).\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        // 4. The web server responds with new JSON data that contains the updated property values based on the new evidence.\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        // 5. The JavaScript integrates the new JSON data and fires the &#39;complete&#39; callback function below, which then displays the results.\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        fod.complete(function (data) {\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;            let fieldValues = [];\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;            if (data.location) {\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;                fieldValues.push([\&quot;Country\&quot;, data.location.country]);\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;                fieldValues.push([\&quot;State\&quot;, data.location.state]);\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;                fieldValues.push([\&quot;County\&quot;, data.location.country]);\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;                fieldValues.push([\&quot;Town/City\&quot;, data.location.town]);\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;            }\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;            else {\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;                fieldValue.push([\&quot;Location data is empty. This probably means that something has gone wrong with the JavaScript evaluation.\&quot;, \&quot;\&quot;])\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;            }\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;            displayValues(fieldValues);\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        }, &#39;location&#39;);\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;    }\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;    function displayValues(fieldValues) {\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        var list = document.createElement(&#39;dl&#39;);\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        fieldValues.forEach(function (entry) {\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;            var name = document.createElement(&#39;dt&#39;);\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;            var value = document.createElement(&#39;dv&#39;);\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;            var bold = document.createElement(&#39;strong&#39;);\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;            var fieldname = document.createTextNode(entry[0]);\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;            var fieldvalue = document.createTextNode(entry[1]);\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;            bold.appendChild(fieldname);\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;            name.appendChild(bold);\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;            value.appendChild(fieldvalue);\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;            list.appendChild(name);\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;            list.appendChild(value);\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        });\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        var element = document.getElementById(&#39;content&#39;);\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;        element.appendChild(list);\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;    }\n&quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;&lt;/script&gt;&quot;</span>);</div><div class="c-code__line">        }</div><div class="c-code__line">    }</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// &lt;editor-fold defaultstate=&quot;collapsed&quot; desc=&quot;HttpServlet methods. Click on the + sign on the left to edit the code.&quot;&gt;</span></div><div class="c-code__line"><span class="c-code__comment"></span>    @Override</div><div class="c-code__line">    <span class="c-code__keyword">protected</span> <span class="c-code__keywordtype">void</span> <a name="a1"></a><a class="code" href="classfiftyone_1_1geolocation_1_1web_1_1examples_1_1servlet_1_1_example.html#a843cc8c80799cc29e682a620ca7bed57">doGet</a>(HttpServletRequest request, HttpServletResponse response)</div><div class="c-code__line">            <span class="c-code__keywordflow">throws</span> ServletException, IOException {</div><div class="c-code__line">        <span class="c-code__keywordflow">try</span> {</div><div class="c-code__line">            <a class="code" href="classfiftyone_1_1geolocation_1_1web_1_1examples_1_1servlet_1_1_example.html#a512a34c561a29823c17e0aef5e57840f">processRequest</a>(request, response);</div><div class="c-code__line">        } <span class="c-code__keywordflow">catch</span> (NoValueException e) {</div><div class="c-code__line">            e.printStackTrace();</div><div class="c-code__line">        }</div><div class="c-code__line">    }</div><div class="c-code__line"></div><div class="c-code__line">    @Override</div><div class="c-code__line">    <span class="c-code__keyword">public</span> String <a name="a2"></a><a class="code" href="classfiftyone_1_1geolocation_1_1web_1_1examples_1_1servlet_1_1_example.html#a55beb4d0d9b63b9b54f574e629ef1355">getServletInfo</a>() {</div><div class="c-code__line">        <span class="c-code__keywordflow">return</span> <span class="c-code__stringliteral">&quot;Short description&quot;</span>;</div><div class="c-code__line">    }<span class="c-code__comment">// &lt;/editor-fold&gt;</span></div><div class="c-code__line"></div><div class="c-code__line">}</div></div> </div><!-- primary -->
</div><!-- inner-->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<section id="nav-path" class="g-footer g-footer--docs"><!-- id is needed for treeview function! -->
    <p class="g-footer__copyright">Generated by
    <a href="http://www.doxygen.org/index.html">
    <b>doxygen</b></a> 1.8.15
  </p>
</section>
</div>
</main>
</div>
</body>
</html>
